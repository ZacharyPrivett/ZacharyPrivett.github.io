YUI.add("anim-node-plugin",function(e,t){var n=function(t){t=t?e.merge(t):{},t.node=t.host,n.superclass.constructor.apply(this,arguments)};n.NAME="nodefx",n.NS="fx",e.extend(n,e.Anim),e.namespace("Plugin"),e.Plugin.NodeFX=n},"3.16.0",{requires:["node-pluginhost","anim-base"]});
YUI.add("anim-scroll",function(e,t){var n=Number;e.Anim.behaviors.scroll={set:function(e,t,r,i,s,o,u){var a=e._node,f=[u(s,n(r[0]),n(i[0])-n(r[0]),o),u(s,n(r[1]),n(i[1])-n(r[1]),o)];f[0]&&a.set("scrollLeft",f[0]),f[1]&&a.set("scrollTop",f[1])},get:function(e){var t=e._node;return[t.get("scrollLeft"),t.get("scrollTop")]}}},"3.16.0",{requires:["anim-base"]});
YUI.add("anchor-repositioner",function(n,e){require("hermes-core/flog")(e);var o=10,i=.25;n.AnchorRepositioner=(function(){function e(){return d.reduce(function(n,e){return n+e.y},0)}function t(){var e,o=n.config.win.location.hash.replace("#","");o&&(e=n.one('[id="'+o+'"], [name="'+o+'"]'))&&r(e)}function r(e){e instanceof n.Node||(e=n.one(e)),s=e}function c(t,c,f){var u,a,d;f=void 0!==f?f:o,c=void 0!==c?c:i,t&&r(t),s&&(s.scrollIntoView(!0),u=n.config.win.scrollY||n.config.win.pageYOffset,a=Math.ceil(s.getY()),d=e()+f,a>=u&&a<=u+d&&(l&&l.stop(),0===c?n.config.win.scrollTo(0,a-d):((l=new n.Anim({duration:c,node:"win",easing:"easeOut",to:{scroll:[0,a-d]}})).on("end",function(n){l=null}),l.run())))}function f(e,o){o instanceof n.Node&&(function(n,e){d.push({key:n,y:e})})(e,parseInt(o.getComputedStyle("height"),10))}function u(n){return d.some(function(e,o){if(e.key===n)return d.splice(o,1),!0})}var a,s,l,d=[];return a||(t(),n.on("hashchange",function(n){t(),c()},n.config.win),a={addOffset:f,removeOffset:u,jumpTo:c,getTotalOffset:e}),a})()},"@VERSION@",{requires:["node","anim"]});YUI.add("atics",function(e,n){var a=require("hermes-core/flog")(n);e.Analytics=(function(){function n(){return document.querySelectorAll("script[src*=adobedtm\\.com]").length<2||!window.s}function t(e){u=e=void 0===e||e,n()&&(u=!1),c("Adobe Analytics enabled: "+u)}function i(e){c("Debugging logging enabled: "+(p=e=void 0===e||e))}function o(n,t){if(t=t||"CTA Link Clicked",window.appEventData.push({linkInfo:{linkId:n},event:t}),e.Snowplough)try{e.Snowplough.sendStructuredEvent({category:t,action:t,label:n})}catch(e){a.error(e)}}function r(){if(!n())try{u&&(!(function(e,n){var a,t={bubbles:!0,cancelable:!0,detail:n};document.createEvent&&document.body.dispatchEvent?((a=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),document.body.dispatchEvent(a)):window.CustomEvent&&document.body.dispatchEvent&&(a=new CustomEvent(e,t),document.body.dispatchEvent(a))})("sendPageView",window.dataLayer),c("Adobe Analytics PageView: "+window.dataLayer.page.pageInfo.pageName+", "+document.location.pathname))}catch(e){c(e)}}function d(){var n=window.appContext.flapp.get("activeView");c("learning"),window.dataLayer={page:{pageInfo:{pageID:"",pageName:"",destinationURL:"",referringURL:"",onsiteSearchTerm:"",language:"",country:"",geoRegion:"",author:"",pageType:"",safetyLevel:""}},product:[],events:[],cart:{},transaction:{transactionID:"",total:{basePrice:0,voucherCode:"",voucherDiscount:0,currency:"",taxRate:0,shipping:0,shippingMethod:"",priceWithTax:0,transactionTotal:0,item:[]}},user:{profile:{profileInfo:{profileID:"",userName:"",language:"",intl:"",signedIn:""},address:"",social:{facebook:"",facebookInfo:"",twitter:"",twitterInfo:""},segment:{isNewRegistration:null,isUserNewCustomer:null,isLoggedIn:null,customerClassDimension:"",visitorLifetimeValue:0}}},feed:{layoutType:"",isInsideOverlay:null,filterType:""},notifications:{notificationType:"",actionType:"",location:""},buckets:{faveIconVariant:null}};try{var a=window.appContext&&window.appContext.getViewer?window.appContext.getViewer():null;a&&(a.signedIn?(window.dataLayer.user.profile.profileInfo.signedIn="signedIn",window.dataLayer.user.profile.profileInfo.profileID=a.nsid,window.dataLayer.user.profile.profileInfo.intl=a.intl,window.dataLayer.user.profile.segment.customerClassDimension=a.isPro?"pro":"free"):window.dataLayer.user.profile.profileInfo.signedIn="signedOut"),window.navigator&&window.navigator.language&&(window.dataLayer.user.profile.profileInfo.language=window.navigator.language),window.dataLayer.page.pageInfo.pageID=e.murmurhash(document.title,document.title+" insecure hawaiian volcano salt"),window.dataLayer.page.pageInfo.pageName=n.name,window.dataLayer.page.pageInfo.destinationURL=document.location.href,window.dataLayer.buckets.exploreVersion=window.appContext.flipper.isFlipped("enable-explore-v2-api")?"2":"1"}catch(e){c("learn() blew up.",e)}}function l(n,a){e.Object.setValue(window.dataLayer,n.split("."),a)}function c(e,n){p&&console.info("[Analytics] ",e,n)}var s,u=!1,p=!1;return s||(window.appEventData=window.appEventData||[],e.one("body").delegate("click",function(e){o(e.target.ancestor("[data-link-id]",!0).getAttribute("data-link-id"))},"a[data-link-id]"),s={sendPageView:r,sendClick:o,enableAdobeAnalytics:t,enableDebugging:i,learn:d,setDataLayerProp:l}),s})()},"@VERSION@",{requires:["murmurhash"],affinity:"client"});YUI.add("snowplough",function(e,n){var o=require("hermes-core/flog")(n),t={USER:"iglu:com.flickr/user/jsonschema/3-0-1",EXPERIMENT:"iglu:com.flickr/experiment/jsonschema/1-0-0",ADD_TO_CART:"iglu:com.snowplowanalytics.snowplow/add_to_cart/jsonschema/1-0-0",SUBSCRIPTION_PURCHASE_EVENT:"iglu:com.flickr/subscription_purchase/jsonschema/1-0-1",SUBSCRIPTION_CANCEL_FLOW_EVENT:"iglu:com.flickr/subscription_cancel/jsonschema/1-0-6",SUBSCRIPTION_PURCHASE_FUNNEL_EVENT:"iglu:com.flickr/subscription_purchase_funnel/jsonschema/1-0-1",PHOTO:"iglu:com.flickr/photo/jsonschema/1-0-2",PAGE:"iglu:com.flickr/page/jsonschema/1-0-0",EVENT_LINK:"iglu:com.flickr/event/jsonschema/1-0-0",GROUP:"iglu:com.flickr/group/jsonschema/1-0-0",GROUP_DISCUSSION:"iglu:com.flickr/group_discussion/jsonschema/2-0-0",GALLERY:"iglu:com.flickr/gallery/jsonschema/4-0-0",ALBUM:"iglu:com.flickr/album/jsonschema/4-0-0",GIFT:"iglu:com.flickr/gift_purchase/jsonschema/1-0-1"};e.Snowplough=(function(){function n(e){var n=[{schema:t.EVENT_LINK,data:{linkID:null}}];return e&&e.linkID&&(n[0].data.linkID=e.linkID.toString()),n}function i(e){if(window.snowplow){var n=r();if(e&&e.getAdditionalSpContexts){var t=e.getAdditionalSpContexts();t.length&&(n=t.concat(n))}o.info("Page view contexts",n),window.snowplow("trackPageView",{context:n}),o.info("Page view event sent")}}function a(){window.snowplow&&window&&window.dataLayer&&window.dataLayer.user&&window.dataLayer.user.profile&&window.dataLayer.user.profile.profileInfo&&(window.snowplow("setUserId",window.dataLayer.user.profile.profileInfo.profileID),o.info("Set snowplow user id",window.dataLayer.user.profile.profileInfo.profileID))}function r(){return[].concat((function(){var e=[{schema:t.PAGE,data:{module:null}}];window&&window.appContext&&window.appContext.flapp&&window.appContext.flapp.get("activeView")&&(e[0].data.module=window.appContext.flapp.get("activeView").name);return e})()).concat((function(){var e=[];if(window&&window.appContext&&window.appContext.flipper&&window.appContext.flipper.config){["enable-likes","enable-payment-request-button","enable-gift-options","enable-google-pay","enable-apple-pay","enable-photo-page-ad-experiment"].forEach(function(n){window.appContext.flipper.config[n]&&e.push({schema:t.EXPERIMENT,data:{flipperName:n,flipperValue:window.appContext.flipper.config[n]}})})}return e})()).concat((function(){var e=[{schema:t.USER,data:{nsid:null,signedIn:null,pro:null,cookie_consent_level:null,hasAdBlock:null}}];if(window&&window.dataLayer&&window.dataLayer.user&&window.dataLayer.user.profile&&window.dataLayer.user.profile.profileInfo){var n=window.dataLayer.user.profile,i=window.appContext.getCookie("ccc")||null;try{i=JSON.parse(i)}catch(e){o.error("Cannot parse JSON in snowplough.js getUserContext")}n.profileInfo.profileID&&(e[0].data.nsid=n.profileInfo.profileID),n.profileInfo.signedIn&&(e[0].data.signedIn="signedIn"===n.profileInfo.signedIn),n.segment.customerClassDimension&&(e[0].data.pro="pro"===n.segment.customerClassDimension),i&&i.info&&i.info.cookieBlock&&i.info.cookieBlock.level&&(e[0].data.cookie_consent_level=i.info.cookieBlock.level),e[0].data.hasAdBlock=window.appContext.getViewer().userAdBlockEnabled,o.info("Called getUserContext to attach with a snowplow event",e)}else o.info("dataLayer empty",window.dataLayer);return e})())}function l(e){return s({id:e.getValue("id"),safetyLevel:e.getValue("safetyLevel"),owner:{nsid:e.getValue("owner").getValue("id"),isPro:e.getValue("owner").getValue("isPro")}})}function s(e){var n=[{schema:t.PHOTO,data:{id:null,safetyLevel:null,owner_nsid:null,owner_isPro:null}}];return e.id&&null!==e.safetyLevel&&(n[0].data.id=parseInt(e.id,10)),null!==e.safetyLevel&&(n[0].data.safetyLevel=parseInt(e.safetyLevel,10)),void 0!==e.owner&&(n[0].data.owner_nsid=e.owner.nsid,n[0].data.owner_isPro=e.owner.isPro),n}function c(e){var n=[{schema:t.GROUP,data:{id:null}}];return e.id&&(n[0].data.id=parseInt(e.id,10)),n}function d(e,n){var o=[];return o=o.concat(c(n)),o=o.concat((function(e){var n=[{schema:t.GROUP_DISCUSSION,data:{id:null}}];return e.id&&(n[0].data.id=parseInt(e.id,10)),n})(e))}function w(e){var n=[{schema:t.GALLERY,data:{id:null,photoIds:null}}];return e.id&&(n[0].data.id=parseInt(e.id,10)),e.photoIds&&e.photoIds.length>0&&(n[0].data.photoIds=e.photoIds),n}function p(e){var n=[{schema:t.ALBUM,data:{id:null,photoIds:null}}];return e.id&&(n[0].data.id=parseInt(e.id,10)),e.photoIds&&e.photoIds.length>0&&(n[0].data.photoIds=e.photoIds),n}function u(e,n){if(window.snowplow&&e){var t=r();n&&n.length>0&&(t=t.concat(n)),t.length>0&&(e.context=t),window.snowplow("trackStructEvent",e),o.info("Structured event sent",e.name,e)}}function f(e){window.snowplow&&e&&(window.snowplow("trackSelfDescribingEvent",{event:{schema:e.schema,data:e.data},context:r()}),o.info("Self describing event sent",e))}function g(e){window.snowplow("trackSiteSearch",{terms:[e.keyword||""],filters:{category:e.category},totalResults:e.totalResults,pageResults:e.pageResults}),o.info("Search event sent",e)}function m(){if(e.Snowplough){var n=new RegExp("_sp_id\\.[a-f0-9]+=([^;]+);?"),o=document.cookie.match(n);return!(!o||!o[1])&&o[1].split(".")[0]}}var h;return h||(h=(function(){if(window&&window.snowplow)return window.snowplow("newTracker","co","t.flickr.com",{appId:"flickr",platform:"web",post:!0,discoverRootDomain:!0,contexts:{webPage:!0,performanceTiming:!0}}),window.snowplow("enableActivityTracking",{minimumVisitLength:10,heartbeatDelay:10}),window.snowplow("enableLinkClickTracking"),o.info("Snowplow ready to collect on t.flickr.com"),{setUserId:a,sendPageView:i,sendStructuredEvent:u,sendSelfDescribingEvent:f,sendSearchEvent:g,getPhotoContext:s,getPhotoContextFromModel:l,getGroupDiscussionContexts:d,getGalleryContext:w,getAlbumContext:p,getGroupContext:c,SCHEMAS:t,getAdsContextEvents:n,getUUID:m};o.error("Missing snowplow.js in window")})()),h})()},"@VERSION@",{requires:["snow"],affinity:"client"});YUI.add("client-app",function(e,n){function i(){C=!1}function t(n){var i,t,r=window.location,o=window.history,a=!1;if(r.search&&o.replaceState&&(i=e.QueryString.parse(r.search.replace("?","")),n.forEach(function(e){e in i&&(delete i[e],a=!0)}),a)){t=e.QueryString.stringify(i);try{o.replaceState({},"",r.pathname+(t?"?"+t:""))}catch(e){}}}function r(e,n){return new n.Promise(function(i,t){n.use(e,function(e,n){n&&"success"in n?n.success?i(e):t(n.msg):t("Y.use: no status provided")})})}function o(n){var i,t,r,o,a=[],s=["flickr.photos.addView","flickr.groups.updateViewDate","flickr.photos.getPhotos","flickr.people.addView","flickr.photosets.addView"];if(w.getViewCounter().flushQueue(),w.uploadIsInProgress())o=this.intlMessage({intlName:"client-app.UPLOAD_IN_PROGRESS"});else{for(i in w.writeAPICallsMadeOnThisPage)(t=w.writeAPICallsMadeOnThisPage[i]).completed||a.push(t);a.length&&(a.every(function(e){return-1!==s.indexOf(e.methodName)})||(e.config.flickr.requestConfig&&e.config.flickr.requestConfig.auth&&e.config.flickr.requestConfig.auth.isInsecureGod?(r=a.map(function(e){return e.methodName}).join(", "),o=this.intlMessage({intlName:"client-app.SAVING_LAST_ACTIONS"})+" In progress API Methods: "+r):o=this.intlMessage({intlName:"client-app.SAVING_LAST_ACTIONS"})))}return e.Storage.Instance.clear(),o&&((n||window.event).returnValue=o),o}function a(n){if(!C)return window.location=n.url,void n.halt();w.setClientSideRouted(!0),w.setPreviousLocation(),w.updateModelRefetchState(n.url,n.originEvent&&n.originEvent.currentTarget&&n.originEvent.currentTarget.hasClass("do-not-evict")),w.clearWriteAPICallCache(),w.setGPCredentials(null),e.loaderBar.start(),w.adManager.isEnabled()&&w.adManager.currentlyShowingAd&&w.adManager.adIsUnloading(),w.adManager.destroyAdUnitsOnPage(),w.getKeyboardManager().resetCurrentKeyEventScope(),e.Object.each(w.modelRegistries,function(e,n){e.hasWeakSubscribers&&e.removeWeakSubscribers()}),v=!0}function s(){e.UA.chrome>0&&(window.scrollTo(window.scrollX,window.scrollY+1),window.scrollTo(window.scrollX,window.scrollY-1))}function c(n){e.Object.each(w.modelRegistries,function(e,n){e.hasWeakSubscribers&&e.removeWeakSubscribers()}),e.fire("close-dialogs"),"popstate"===n.src&&s(),"popstate"!==n.src||h.hasRoute(h.getPath())||e.Object.isEmpty(n.newVal)||h.navigate(h.getPath()),w.getViewCounter().flushQueue({resetDuplicateTracking:!0}),v||w.updateModelRefetchState(),v=!1}function l(e){h.set("previousView",e.prevVal)}function u(n,i,t){var r=e.one(document.elementFromPoint(i,t)),o=r.ancestor("[data-scroll-section]",!0);if(o)return o.getAttribute("data-scroll-section");var a,s=r.ancestor(".view",!0);if(s){if((a=s.getAttribute("class").match(/[\S]+-view/)[0])===n.name&&i===window.innerWidth/2){var c=u(n,i/2,t);return c!==n.name?c:u(n,i+i/2,t)}return a}}function d(n){var i=this.get("activeView");if(void 0===i.getViewDataFromHistory("referrer")&&i.setViewDataOnHistory("referrer",w.getPreviousURL()),e.Analytics&&(e.Analytics.learn(),i.updateDataLayer(),e.Analytics.sendPageView()),e.Snowplough&&e.Snowplough.sendPageView(i),e.DeferImages.update(),w.adManager.setAdCouldBeShown(!1),e.config.win.onappclientnav)try{e.config.win.onappclientnav()}catch(n){}e.Accessibility.manageFocusOutlines(i),void 0!==window._sift&&window._sift.push&&window._sift.push(["_trackPageview"]),y&&w.requiresCookieConsent&&f(),window.addEventListener("message",function(e){"flickr:CMPframed"===e.data&&(y=!0,w.requiresCookieConsent&&f())})}function f(){window.__tcfapi&&window.__tcfapi("ping",2,function(n){n.cmpLoaded||(m.info("CMP Loaded value is false"),e.Snowplough&&e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_issue",label:"cmpLoaded undefined"}))})}function g(n){return new e.Promise(function(i,r){var o=setTimeout(function(){r(new Error("Initial View Timeout"))},12e3);n.params.appContext=w,h.showContent(e.one("#content > .view"),{view:{name:n.name,config:n.params}},function(n){e.one("body").removeClass("dark-loader"),n._params&&(n._params.keyEventScope=n.name+n._yuid),n.setViewDataOnHistory("referrer",document.referrer),n.set("isRootView",!0),n.initialize().then(function(){e.Analytics&&(e.Analytics.learn(),e.Analytics.enableAdobeAnalytics(),n.updateDataLayer(),e.Analytics.sendPageView()),e.Snowplough&&(e.Snowplough.setUserId(),e.Snowplough.sendPageView(n)),w.getKeyboardManager().setCurrentKeyEventScope(n.name+n._yuid),s(),e.DeferImages.init(),e.Accessibility.manageFocusOutlines(n),t(["campaignID","linkID"]),(function(){if(e.config.flickr.requestConfig&&e.config.flickr.requestConfig.auth&&e.config.flickr.requestConfig.auth.isInsecureGod){var n=e.all("[data-view-signature]");n.size()&&m.warn("View signature mismatches detected! A view likely modified the `params` object directly.",{views:n.getDOMNodes()})}})(),clearTimeout(o),i()}).then(null,function(e){throw m.error("There was a problem initializing or activating the view.",{err:e}),r(),e}),y&&w.requiresCookieConsent&&f(),window.addEventListener("message",function(e){"flickr:CMPframed"===e.data&&(y=!0,w.requiresCookieConsent&&f())})}),h.before("navigate",a),h.before("activeViewChange",l),e.on("history:change",c),h.after("activeViewChange",d)})}function p(n,i,t,r){var o={};return e.Views&&e.Views[n]&&(o[n]={type:e.Views[n],preserve:!1}),h=new e.App({serverRouting:!0,viewContainer:"#content",container:"#content",linkSelector:":not(.server-only-link):not([target=_blank])",scrollToTop:!1,views:o}),new e.FlickrRouter(h,e.config.flickr.routes),r.auth=i,r.flapp=h,w=(function(n){return window.appContext=new e.AppContext(n),window.appContext})(r),w.routeTiming=r.routeTiming,w.routeConfig=r.routeConfig,e.mix(e.Node.DOM_EVENTS,{transitionend:!0,webkitTransitionEnd:!0}),i&&i.user&&i.user.ispro||e.use("prbd"),e.ClientTransport.authorize(w),window.snowplough=e.Snowplough,window.addEventListener("unload",function(n){e.ClientTransport.unloading=!0}),window.addEventListener("load",function(n){e.ClientTransport.unloading=!1}),w.adManager.detectAdBlocker(),w.modelImportExport.importAll(t)}var w,h,m=require("hermes-core/flog")(n),v=!1,C=e.config.flickr.clientNavEnabled,y=!1;e.ClientApp={init:function(n){if(void 0===n)return e.Promise.reject({message:"Invalid config object supplied, was undefined."});var a,s,c=n.initialView,l=n.modelExport,u=n.auth,d=this;return u||i(),a=u&&n.auth.signedIn?n.auth.csrf:null,e.config.flickr.csrf.token=a,e.config.flickr.requestConfig={auth:u},n.params.routeTiming=n.routeTiming,n.params.routeConfig=n.routeConfig,n.audienceTargets&&n.params.flipper["enable-audience-tgt"]&&(n.params.audienceTargets=n.audienceTargets),t(e.config.flickr.routing_params),window.location.search&&window.location.search.match(/yc=/)&&(s=e.QueryString.parse(window.location.search.replace("?","")),e.config.flickr.ycParam=s.yc),e.transportFactory=function(n,i){return new e.ClientTransport(i)},r(c.name,e).then(function(){return p(c.name,u,l,n.params)}).then(function(){return g(c)}).then(function(){!(function(){var n=e.one("link#rollup-css");n?n.get("sheet")?(w.isCSSLoaded=!0,e.fire("css-loaded")):n.once("load",function(){w.isCSSLoaded=!0,e.fire("css-loaded")}):(w.isCSSLoaded=!0,e.fire("css-loaded"))})(),e.AnchorRepositioner.jumpTo(),e.config.win.addEventListener("beforeunload",o.bind(d))}).then(e.config.win.onappinit)},beforeUnload:o,beforeNavigate:a,_loadInitialView:r,langBundles:["client-app"],disableClientNav:i,getScrollSection:u},e.rapidTracker={beacon:function(){}},e.mix(e.ClientApp,e.Localizable)},"@VERSION@",{requires:["app-base","app-content","router","app-context","client-transport","flickr-router","handlebars-helpers","loader-bar","murmurhash","node","site-key","flickr-promise","global-events","querystring-parse-simple","querystring-stringify-simple","storage-helper","keyboard-manager","dom","overflow-helper","defer-images","accessibility","anchor-repositioner","atics","snowplough"],affinity:"client",langBundles:["client-app"]});YUI.add("csrf-updater",function(t){"use strict";var e=require("hermes-core/flog")("csrf");t.CsrfUpdater=function(t){this.flickrAPI=t,this._tasks=[]},t.CsrfUpdater.prototype.getKey=function(){return t.config.flickr.csrf.token||null},t.CsrfUpdater.prototype.isExpired=function(){return!!t.config.flickr.csrf.token&&Date.now()/1e3>t.config.flickr.csrf.csrfExpiresAt},t.CsrfUpdater.prototype.invalidate=function(t){var e=this._lastStored||0;if(t||(t=0),!(t<e))return this.setExpired()},t.CsrfUpdater.prototype.setExpired=function(){return t.config.flickr.csrf.csrfExpiresAt=0},t.CsrfUpdater.prototype.store=function(e,r){this._lastStored=Date.now(),r||(r=Math.floor(this._lastStored/1e3)),t.config.flickr.csrf.token=e,t.config.flickr.csrf.csrfFetched=r,t.config.flickr.csrf.csrfExpiresAt=r+t.config.flickr.csrf.fetch_interval,this.drainQueue()},t.CsrfUpdater.prototype.pushToQueue=function(t){this._tasks.push(t)},t.CsrfUpdater.prototype.drainQueue=function(){for(;this._tasks.length;)this._tasks.shift().resolve()},t.CsrfUpdater.prototype.hasQueuedTasks=function(){return!!this._tasks.length},t.CsrfUpdater.prototype.scheduleFutureFetch=function(){t.config.flickr.csrf.token&&(this._timerFutureFetch=setTimeout(this.fetch.bind(this),1e3*t.config.flickr.csrf.fetch_interval))},t.CsrfUpdater.prototype.scheduleRetry=function(e){var r=this,s=this._fetchRuns>4?1:Math.pow(2,(this._fetchRuns||1)-1)/10,i=t.config.flickr.csrf.retry_interval*s;clearTimeout(this._timerRetry),this._timerRetry=setTimeout(function(){r._timerRetry=null,r.fetch(e)},1e3*i)},t.CsrfUpdater.prototype.fetch=function(r){var s=this,i=s.hasQueuedTasks();if(clearTimeout(this._timerFutureFetch),YUI.Env.isServer){if(!r&&(r=new t.Promise(function(t,e){this.resolve=t,this.reject=e}),this.pushToQueue(r),i))return r;this._fetchRuns||(this._fetchRuns=0),this._fetchRuns++,this.flickrAPI.fetchCsrf().then(function(t){var i=t.token;if(!t.token)return e.error("Failed to fetch csrf token",t),void s.scheduleRetry(r);e.log("Received new csrf token",t),s._fetchRuns=0,s.store(i),s.scheduleFutureFetch()},function(t){e.error("Failed to fetch csrf token",{err:t}),s.scheduleRetry(r)})}else t.ClientApp&&(t.ClientApp.disableClientNav(),e.error("Cannot fetch CSRF on client"),r=t.Promise.reject({msg:"csrf is unavailable"}));return r}},"@VERSION@",{requires:["client-app"]});YUI.add("hermes-template-pro-badge",function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,o,a){var r,t=null!=l?l:n.nullContext||{},i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t<a "+(null!=(r=i(e,"if").call(t,null!=l?i(l,"noLink"):l,{name:"if",hash:{},fn:n.noop,inverse:n.program(2,a,0),data:a,loc:{start:{line:2,column:4},end:{line:2,column:114}}}))?r:"")+' class="pro-badge-new pro-badge-legacy'+(null!=(r=i(e,"if").call(t,null!=l?i(l,"noLink"):l,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:152},end:{line:2,column:181}}}))?r:"")+(null!=(r=i(e,"if").call(t,null!=l?i(l,"light"):l,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:181},end:{line:2,column:207}}}))?r:"")+(null!=(r=i(e,"if").call(t,null!=l?i(l,"extraClasses"):l,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:207},end:{line:2,column:251}}}))?r:"")+'" title="'+n.escapeExpression((i(e,"intlMessage")||l&&i(l,"intlMessage")||n.hooks.helperMissing).call(t,{name:"intlMessage",hash:{intlName:"common.FLICKR_LOVES_OLD_SCHOOL_PROS"},data:a,loc:{start:{line:2,column:260},end:{line:2,column:322}}}))+'">\n'+(null!=(r=i(e,"if").call(t,null!=l?i(l,"light"):l,{name:"if",hash:{},fn:n.program(13,a,0),inverse:n.program(15,a,0),data:a,loc:{start:{line:4,column:2},end:{line:8,column:9}}}))?r:"")+"\t</a>\n"},2:function(n,l,e,o,a){var r,t=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=t(e,"if").call(null!=l?l:n.nullContext||{},null!=l?t(l,"purchaseProURL"):l,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:2,column:18},end:{line:2,column:107}}}))?r:""},3:function(n,l,e,o,a){var r,t=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'href="'+n.escapeExpression("function"==typeof(r=null!=(r=t(e,"purchaseProURL")||(null!=l?t(l,"purchaseProURL"):l))?r:n.hooks.helperMissing)?r.call(null!=l?l:n.nullContext||{},{name:"purchaseProURL",hash:{},data:a,loc:{start:{line:2,column:46},end:{line:2,column:64}}}):r)+'"'},5:function(n,l,e,o,a){return'href="/account/upgrade/pro"'},7:function(n,l,e,o,a){return" no-link"},9:function(n,l,e,o,a){return" light"},11:function(n,l,e,o,a){var r,t=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return" "+n.escapeExpression("function"==typeof(r=null!=(r=t(e,"extraClasses")||(null!=l?t(l,"extraClasses"):l))?r:n.hooks.helperMissing)?r.call(null!=l?l:n.nullContext||{},{name:"extraClasses",hash:{},data:a,loc:{start:{line:2,column:228},end:{line:2,column:244}}}):r)},13:function(n,l,e,o,a){return'\t\t\t<svg class="icon icon-old-pro-badge"><use xlink:href="#icon-old-pro-badge-colorless"></use></svg>\n'},15:function(n,l,e,o,a){return'\t\t\t<svg class="icon icon-old-pro-badge-color"><use xlink:href="#icon-old-pro-badge"></use></svg>\n'},17:function(n,l,e,o,a){var r,t=null!=l?l:n.nullContext||{},i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t<a "+(null!=(r=i(e,"if").call(t,null!=l?i(l,"noLink"):l,{name:"if",hash:{},fn:n.noop,inverse:n.program(2,a,0),data:a,loc:{start:{line:11,column:4},end:{line:11,column:114}}}))?r:"")+' class="pro-badge-new'+(null!=(r=i(e,"if").call(t,null!=l?i(l,"noLink"):l,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:11,column:135},end:{line:11,column:164}}}))?r:"")+(null!=(r=i(e,"if").call(t,null!=l?i(l,"light"):l,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:11,column:164},end:{line:11,column:190}}}))?r:"")+(null!=(r=i(e,"if").call(t,null!=l?i(l,"extraClasses"):l,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:11,column:190},end:{line:11,column:234}}}))?r:"")+'">\n\t\t<svg class="icon icon-pro-badge"><use xlink:href="#icon-pro-badge"></use></svg>\n\t</a>\n'},compiler:[8,">= 4.3.0"],main:function(n,l,e,o,a){var r,t=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=(t(e,"ifCond")||l&&t(l,"ifCond")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?t(l,"badgeType"):l,"===","legacy",{name:"ifCond",hash:{},fn:n.program(1,a,0),inverse:n.program(17,a,0),data:a,loc:{start:{line:1,column:0},end:{line:14,column:11}}}))?r:""},useData:!0}),o={};n.Array.each([],function(l){var e=n.Template.get("hermes/"+l);e&&(o[l]=e)}),n.Template.register("hermes/pro-badge",function(l,a){return a=a||{},a.partials=a.partials?n.merge(o,a.partials):o,e(l,a)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-card-header",function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,o){return" compact"},3:function(n,t,l,e,o){return" theme-overlay"},5:function(n,t,l,e,o){var a,r,i=null!=t?t:n.nullContext||{},u=n.hooks.helperMissing,c=n.escapeExpression,s=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<a\n\t\t\t\tclass="avatar no-refresh\n\t\t\t\t\t'+(null!=(a=s(l,"if").call(i,null!=t?s(t,"isCompact"):t,{name:"if",hash:{},fn:n.program(6,o,0),inverse:n.program(8,o,0),data:o,loc:{start:{line:8,column:5},end:{line:8,column:52}}}))?a:"")+"\n\t\t\t\t\t"+(null!=(a=s(l,"if").call(i,null!=t?s(t,"isPersonAttribution"):t,{name:"if",hash:{},fn:n.program(10,o,0),inverse:n.noop,data:o,loc:{start:{line:9,column:5},end:{line:9,column:46}}}))?a:"")+"\n\t\t\t\t\t"+(null!=(a=s(l,"if").call(i,null!=t?s(t,"isGroupAttribution"):t,{name:"if",hash:{},fn:n.program(12,o,0),inverse:n.noop,data:o,loc:{start:{line:10,column:5},end:{line:10,column:44}}}))?a:"")+'"\n\t\t\t\tstyle="background-image: url('+c("function"==typeof(r=null!=(r=s(l,"iconUrl")||(null!=t?s(t,"iconUrl"):t))?r:u)?r.call(i,{name:"iconUrl",hash:{},data:o,loc:{start:{line:11,column:33},end:{line:11,column:44}}}):r)+');"\n\t\t\t\thref="'+c("function"==typeof(r=null!=(r=s(l,"url")||(null!=t?s(t,"url"):t))?r:u)?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:12,column:10},end:{line:12,column:17}}}):r)+'"\n\t\t\t\t'+(null!=(a=s(l,"if").call(i,null!=t?s(t,"isPersonAttribution"):t,{name:"if",hash:{},fn:n.program(14,o,0),inverse:n.noop,data:o,loc:{start:{line:13,column:4},end:{line:13,column:74}}}))?a:"")+"\n\t\t\t\t"+(null!=(a=s(l,"if").call(i,null!=t?s(t,"isGroupAttribution"):t,{name:"if",hash:{},fn:n.program(16,o,0),inverse:n.noop,data:o,loc:{start:{line:14,column:4},end:{line:14,column:72}}}))?a:"")+"></a>\n"},6:function(n,t,l,e,o){return" very-tiny"},8:function(n,t,l,e,o){return" tiny"},10:function(n,t,l,e,o){return" person"},12:function(n,t,l,e,o){return" group"},14:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'data-person-nsid="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"attributionId")||(null!=t?r(t,"attributionId"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"attributionId",hash:{},data:o,loc:{start:{line:13,column:49},end:{line:13,column:66}}}):a)+'"'},16:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'data-group-nsid="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"attributionId")||(null!=t?r(t,"attributionId"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"attributionId",hash:{},data:o,loc:{start:{line:14,column:47},end:{line:14,column:64}}}):a)+'"'},18:function(n,t,l,e,o){var a,r,i=null!=t?t:n.nullContext||{},u=n.hooks.helperMissing,c=n.escapeExpression,s=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<div class="title-container">\n\t\t\t\t\t<a class="title" href="'+c("function"==typeof(r=null!=(r=s(l,"url")||(null!=t?s(t,"url"):t))?r:u)?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:19,column:28},end:{line:19,column:35}}}):r)+'">'+c("function"==typeof(r=null!=(r=s(l,"title")||(null!=t?s(t,"title"):t))?r:u)?r.call(i,{name:"title",hash:{},data:o,loc:{start:{line:19,column:37},end:{line:19,column:46}}}):r)+"</a>\n"+(null!=(a=s(l,"if").call(i,null!=t?s(t,"showProBadge"):t,{name:"if",hash:{},fn:n.program(19,o,0),inverse:n.noop,data:o,loc:{start:{line:20,column:5},end:{line:26,column:12}}}))?a:"")+"\t\t\t\t</div>\n"},19:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=(r(l,"ifCond")||t&&r(t,"ifCond")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},null!=t?r(t,"theme"):t,"===","overlay",{name:"ifCond",hash:{},fn:n.program(20,o,0),inverse:n.program(22,o,0),data:o,loc:{start:{line:21,column:6},end:{line:25,column:17}}}))?a:""},20:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=n.invokePartial(r(e,"pro-badge"),t,{name:"pro-badge",hash:{purchaseProURL:null!=t?r(t,"purchaseProURL"):t,light:!0,badgeType:null!=t?r(t,"proBadgeType"):t},data:o,indent:"\t\t\t\t\t\t\t",helpers:l,partials:e,decorators:n.decorators}))?a:""},22:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(a=n.invokePartial(r(e,"pro-badge"),t,{name:"pro-badge",hash:{purchaseProURL:null!=t?r(t,"purchaseProURL"):t,badgeType:null!=t?r(t,"proBadgeType"):t},data:o,indent:"\t\t\t\t\t\t\t",helpers:l,partials:e,decorators:n.decorators}))?a:""},24:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t<div class="card-details">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"activityName"):t,{name:"if",hash:{},fn:n.program(25,o,0),inverse:n.noop,data:o,loc:{start:{line:32,column:5},end:{line:35,column:12}}}))?a:"")+'\t\t\t\t\t<span class="time">\n\t\t\t\t\t\t'+(null!=(a=(i(l,"friendlySinceDate")||t&&i(t,"friendlySinceDate")||n.hooks.helperMissing).call(r,null!=t?i(t,"time"):t,!0,!0,{name:"friendlySinceDate",hash:{},fn:n.program(27,o,0),inverse:n.noop,data:o,loc:{start:{line:37,column:6},end:{line:37,column:108}}}))?a:"")+"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n"},25:function(n,t,l,e,o){var a,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t\t\t\t<span class="activity-type">'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"activityName")||(null!=t?r(t,"activityName"):t))?a:n.hooks.helperMissing)?a.call(null!=t?t:n.nullContext||{},{name:"activityName",hash:{},data:o,loc:{start:{line:33,column:34},end:{line:33,column:50}}}):a)+'</span>\n\t\t\t\t\t\t<span class="separator">&middot;</span>\n'},27:function(n,t,l,e,o){var a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return n.escapeExpression((a(l,"intlMessage")||t&&a(t,"intlMessage")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},{name:"intlMessage",hash:{time:null!=t?a(t,"time"):t,intlName:null!=t?a(t,"intlName"):t},data:o,loc:{start:{line:37,column:43},end:{line:37,column:86}}}))},29:function(n,t,l,e,o){return'\t\t\t<div role="button" class="menu-button">\n\t\t\t\t<svg class="icon icon-more_horizontal"><use xlink:href="#icon-more_horizontal"></use></svg>\n\t\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,o){var a,r=null!=t?t:n.nullContext||{},i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'<div class="photo-card-header\n\t'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"isCompact"):t,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:2,column:1},end:{line:2,column:33}}}))?a:"")+"\n\t"+(null!=(a=(i(l,"ifCond")||t&&i(t,"ifCond")||n.hooks.helperMissing).call(r,null!=t?i(t,"theme"):t,"===","overlay",{name:"ifCond",hash:{},fn:n.program(3,o,0),inverse:n.noop,data:o,loc:{start:{line:3,column:1},end:{line:3,column:59}}}))?a:"")+'">\n\t<div class="left-container">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"iconUrl"):t,{name:"if",hash:{},fn:n.program(5,o,0),inverse:n.noop,data:o,loc:{start:{line:5,column:2},end:{line:15,column:9}}}))?a:"")+'\t\t<div class="attribution">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"title"):t,{name:"if",hash:{},fn:n.program(18,o,0),inverse:n.noop,data:o,loc:{start:{line:17,column:3},end:{line:28,column:10}}}))?a:"")+"\n"+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showDetails"):t,{name:"if",hash:{},fn:n.program(24,o,0),inverse:n.noop,data:o,loc:{start:{line:30,column:3},end:{line:40,column:10}}}))?a:"")+'\t\t</div>\n\t</div>\n\t<div class="right-container">\n'+(null!=(a=i(l,"if").call(r,null!=t?i(t,"showMenu"):t,{name:"if",hash:{},fn:n.program(29,o,0),inverse:n.noop,data:o,loc:{start:{line:44,column:2},end:{line:48,column:9}}}))?a:"")+"\t</div>\n</div>\n"},usePartial:!0,useData:!0}),e={};n.Array.each(["pro-badge","pro-badge"],function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)}),n.Template.register("hermes/photo-card-header",function(t,o){return o=o||{},o.partials=o.partials?n.merge(e,o.partials):e,l(t,o)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-pro-badge","hermes-template-pro-badge"]});YUI.add("photo-card-helper",function(e,t){e.mix({langBundles:["common","feed","feed-new"]},e.Localizable);var a=require("justified-layout");e.PhotoCardHelper=function(t){var i={layoutValues:{large:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT:150,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,BATCH_ROW_HEIGHT_RATIO:.5},medium:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3},compact:{BATCH_CARD_SPACING:8,BATCH_TARGET_ROW_HEIGHT:180,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,SINGLE_PHOTO_HEIGHT:250}},ATTRIBUTION_HEADER_HEIGHT:58,DETAILS_FOOTER_HEIGHT:70,INFO_BAR_HEIGHT:52,MAX_PHOTO_AR:2.5,MIN_PHOTO_AR:.5,MANUAL_PORTRAIT_AR:.75,MANUAL_LANDSCAPE_AR:2,getCappedPhotoHeight:function(e){e.height;return Math.min(e.height,Math.max(t.viewportData.getHeight()*e.viewportProportion-e.additionalCardHeight,e.minHeight))},getClampedPhotoAspectRatio:function(e){return Math.min(Math.max(e,this.MIN_PHOTO_AR),this.MAX_PHOTO_AR)},generateCompactBatchLayout:function(e){var t,i=this,o=[],u=1===e.photoItems.length?this.layoutValues.compact.SINGLE_PHOTO_HEIGHT:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT;o=e.photoItems.map(function(e){return i.getClampedPhotoAspectRatio(e.aspectRatio)}),(t=a(o,{containerWidth:e.width,containerPadding:0,boxSpacing:{horizontal:this.layoutValues.compact.BATCH_CARD_SPACING,vertical:this.layoutValues.compact.BATCH_CARD_SPACING},targetRowHeight:u,targetRowHeightTolerance:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT_TOLERANCE})).width=e.width;var s=t.boxes[0].top,l=[0],n=0;return t.boxes.some(function(e,a){if(e.top>s){if(n+=t.boxes[l[l.length-1]].height+i.layoutValues.compact.BATCH_CARD_SPACING,l.push(a),l.length>3)return!0;s=e.top}}),l.length>3&&(t.boxes=t.boxes.slice(0,l[l.length-1]),t.containerHeight=n),t},generateThreeMaxLayout:function(e){var a=this,i={},o=[],u=[],s=e.photoItems.length;return u=e.photoItems.map(function(e){return a.getClampedPhotoAspectRatio(e.aspectRatio)}),2===(u=u.slice(0,3)).length?u[0]>1&&u[1]>1?(o.push(u.slice(0,1)),o.push(u.slice(1,2)),i=this.buildCustomRowsLayout(o,e)):(o.push(u.slice(0,2)),i=this.buildCustomRowsLayout(o,e)):3===u.length&&(u[0]>1&&u[1]>1&&u[2]>1?(o.push(u.slice(0,1)),o.push(u.slice(1,3)),i=this.buildCustomRowsLayout(o,e)):u[0]>1&&u[1]>1&&u[2]<=1?(o.push(u.slice(0,1)),o.push(u.slice(1,3)),i=this.buildCustomRowsLayout(o,e)):u[0]>1&&u[1]<=1&&u[2]>1?(o.push(u.slice(0,1)),o.push(u.slice(1,3)),i=this.buildCustomRowsLayout(o,e)):u[0]>1&&u[1]<=1&&u[2]<=1?(o.push(u.slice(0,1)),o.push(u.slice(1,3)),i=this.buildCustomRowsLayout(o,e)):u[0]<=1&&u[1]>1&&u[2]>1?(s>3?o.push(u.slice(0,2)):(o.push(u.slice(0,2)),o.push(u.slice(2,3))),i=this.buildCustomRowsLayout(o,e)):u[0]<=1&&u[1]>1&&u[2]<=1?(o.push(u.slice(0,2)),i=this.buildCustomRowsLayout(o,e)):u[0]<=1&&u[1]<=1&&u[2]>1?(s>3?o.push(u.slice(0,2)):(o.push(u.slice(0,2)),o.push(u.slice(2,3))),i=this.buildCustomRowsLayout(o,e)):u[0]<=1&&u[1]<=1&&u[2]<=1&&(o.push(u.slice(0,3)),i=this.buildCustomRowsLayout(o,e))),Math.max.apply(Math,i.boxes.map(function(e){return e.height}))>.8*t.viewportData.getHeight()&&((o=[]).push(u.slice(0,2)),i=this.buildCustomRowsLayout(o,e)),i},buildCustomRowsLayout:function(e,t){var a=this,i=0,o={boxes:[]};return e.forEach(function(u,s){var l={horizontal:a.layoutValues.large.BATCH_CARD_SPACING,vertical:a.layoutValues.large.BATCH_CARD_SPACING},n=a.generateCustomJustifiedRow(u,{containerWidth:t.width,padding:l.horizontal,top:0===s?0:i});o.boxes=o.boxes.concat(n),i+=s!==e.length-1?n[0].height+l.vertical:n[0].height}),o.containerHeight=i,o},generateCustomJustifiedRow:function(e,t){var a=e.reduce(function(e,t,a){return e+t},0),i=(t.containerWidth-t.padding*(e.length-1))/a,o=0;return e.map(function(e,a){var u=o;return o+=i*e+t.padding,{aspectRatio:e,width:i*e,height:i,left:u,top:t.top}})},scaleLayout:function(e,t,a,i,o){var u,s=0,l=0,n=[];return e.boxes.forEach(function(e,a){i||(e.width*=t,e.left*=t),o||(e.height*=t,e.top*=t)}),n.push([]),e.boxes.forEach(function(e,t){e.top>l&&(s++,l=e.top,n.push([])),n[s].push(e)}),u=0,n.forEach(function(s,l){var h=a,r=h*t,g=0;s.forEach(function(e,t){i||(e.width-=(h-r)*(s.length-1)/s.length,e.left=g+t*h,g+=e.width),o||(e.height-=(h-r)*(n.length-1)/n.length,e.top=u+l*h,t===s.length-1&&(u+=s[0].height))}),i||(e.width=g+(s.length-1)*h)}),o||(e.containerHeight=u+(n.length-1)*a),e},convertPhotoModel:function(t){var a,i=t.getValue("owner"),o=t.getValue("engagement"),u=i.getValue("isPro");return"photo-lite-models"===t.registry.name?(a=this.convertEngagementModel(t),{id:e.guid(),layoutRenderType:"photo",photoId:t.getValue("id"),aspectRatio:t.getValue("aspectRatio"),sizes:t.getValue("sizes"),url:t.getValue("url"),title:t.getValue("title"),description:t.getValue("description"),mediaType:t.getValue("mediaType"),isVideo:t.getValue("isVideo"),owner:{nsid:i.getValue("nsid"),url:i.getValue("url"),displayname:i.getValue("displayname"),pathAlias:i.getValue("pathAlias"),isPro:u,proBadgeType:u?i.getValue("proBadge"):void 0,model:t.getValue("owner")},engagement:a,isOwner:t.getValue("isOwner"),needsInterstitial:t.getValue("needsInterstitial"),model:t,engagementModel:o}):(a=this.convertEngagementModel(o),{id:e.guid(),layoutRenderType:"photo",photoId:t.getValue("id"),aspectRatio:t.getValue("aspectRatio"),sizes:t.getValue("sizes"),url:t.getValue("url"),title:t.getValue("title"),description:t.getValue("description"),mediaType:t.getValue("mediaType"),isVideo:t.getValue("isVideo"),owner:{nsid:i.getValue("nsid"),url:i.getValue("url"),displayname:i.getValue("displayname"),buddyicon:i.getValue("buddyicon"),pathAlias:i.getValue("pathAlias"),isPro:u,proBadgeType:u?i.getValue("proBadge"):void 0,model:t.getValue("owner")},engagement:a,isOwner:t.getValue("isOwner"),needsInterstitial:t.getValue("needsInterstitial"),safetyLevel:t.getValue("safetyLevel"),model:t,engagementModel:o})},convertEngagementModel:function(e){return"photo-lite-models"===e.registry.name?{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}:{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),viewCount:e.getValue("viewCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}}};return e.augment(i,e.EventTarget),i}},"@VERSION@",{requires:["event-custom","storage-helper"]});