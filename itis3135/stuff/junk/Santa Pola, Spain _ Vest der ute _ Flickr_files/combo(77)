YUI.add("photo-list-subview",function(e,t){var r=require("hermes-core/type-validator"),o=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.PhotoListSubview=e.Base.create(this.name,e.FlickrView,[],{downloadCacheAndSetImage:function(){e.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(t,r){var o=this.get("photoContainer");o.setStyle("backgroundImage","url("+r+")"),t||o.setStyle("backgroundColor","#eee"),this.get("model").getValue("needsInterstitial")&&o.addClass("restricted-image"),e.fluid.chill(function(){this.fire(t?"loaded":"loadError")},this)},updateGeometry:function(e){e?this.set("layoutItem",e):e=this.get("layoutItem"),this.updateNodeGeometry(e,this.get("container"))},updateNodeGeometry:function(t,r){YUI.Env.isServer?r.setStyles({transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):e.fluid.setStylePrefixed("transform","translate("+t.geometry.left+"px, "+t.geometry.top+"px)",r),t.forcedAspectRatio&&r.addClass("forced-aspect-ratio"),r.setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px"})}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return r.photoId(e)}},layoutItem:{validator:function(e,t){return"object"==typeof e&&e.hasOwnProperty("aspectRatio")&&e.hasOwnProperty("geometry")&&"object"==typeof e.geometry&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")&&e.hasOwnProperty("isAwake")}},listModelParams:{writeOnce:"initOnly"},photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var r=this.get("model"),o=this.get("layoutItem");return r.getSizeToFit({width:o.geometry.width*this.get("photoContainerSize"),height:o.geometry.height*this.get("photoContainerSize")},{includeSquare:!1}).url}},linkedPageUrl:{writeOnce:!0,validator:function(t,r){return e.AttributeHelpers.validateString(t)}},model:{value:null},photoContainer:{readOnly:!0,derivedBy:["container"],getter:function(e){return YUI.Env.isServer?(o.warn("Cannot access photoContainer on the server; set values in the template instead. Falling back to view container."),this.get("container")):this.get("container").one(".photo")}},photoContainerSize:{value:1},measureAFT:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","attribute-helpers"],optionalRequires:["fluid"]});YUI.add("hermes-template-photo-list-tag",function(l,e){var n=l.Template.Handlebars.revive({1:function(l,e,n,a,t){return" is-video"},3:function(l,e,n,a,t){return" restricted-image"},compiler:[8,">= 4.3.0"],main:function(l,e,n,a,t){var o,r,i=null!=e?e:l.nullContext||{},s=l.hooks.helperMissing,u=l.escapeExpression,c=l.lookupProperty||function(l,e){if(Object.prototype.hasOwnProperty.call(l,e))return l[e]};return'<a href="'+u("function"==typeof(r=null!=(r=c(n,"linkedPageUrl")||(null!=e?c(e,"linkedPageUrl"):e))?r:s)?r.call(i,{name:"linkedPageUrl",hash:{},data:t,loc:{start:{line:1,column:9},end:{line:1,column:26}}}):r)+'"><div class="overlay"><div class="tag">'+u("function"==typeof(r=null!=(r=c(n,"tag")||(null!=e?c(e,"tag"):e))?r:s)?r.call(i,{name:"tag",hash:{},data:t,loc:{start:{line:1,column:66},end:{line:1,column:73}}}):r)+'</div></div>\n<div class="photo'+(null!=(o=c(n,"if").call(i,null!=(o=null!=e?c(e,"photo"):e)?c(o,"isVideo"):o,{name:"if",hash:{},fn:l.program(1,t,0),inverse:l.noop,data:t,loc:{start:{line:2,column:17},end:{line:2,column:54}}}))?o:"")+" "+(null!=(o=c(n,"if").call(i,null!=(o=null!=e?c(e,"photo"):e)?c(o,"needsInterstitial"):o,{name:"if",hash:{},fn:l.program(3,t,0),inverse:l.noop,data:t,loc:{start:{line:2,column:55},end:{line:2,column:110}}}))?o:"")+'" style="background-image: url(\''+u("function"==typeof(r=null!=(r=c(n,"photoUrl")||(null!=e?c(e,"photoUrl"):e))?r:s)?r.call(i,{name:"photoUrl",hash:{},data:t,loc:{start:{line:2,column:142},end:{line:2,column:154}}}):r)+"');\"></div></a>\n"},useData:!0}),a={};l.Array.each([],function(e){var n=l.Template.get("hermes/"+e);n&&(a[e]=n)}),l.Template.register("hermes/photo-list-tag",function(e,t){return t=t||{},t.partials=t.partials?l.merge(a,t.partials):a,n(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-list-tag-view",function(t,e){var i=require("hermes-core/flog")(e);t.namespace("Views")[this.name]=t.Base.create(this.name,t.PhotoListSubview,[],{langBundles:this.details.langBundles,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){return t.Promise.resolve()},buildContainer:function(){var t={};return t.linkedPageUrl="/photos/tags/"+this.get("model").id,t.photoUrl=this.get("photoUrl"),t.photo=this.get("model").toJSON(),t.tag=this.get("model").id,this.updateGeometry(),YUI.Env.isServer||this.downloadCacheAndSetImage(),this.setContainerWithTemplate("photo-list-tag",t),this},activate:function(){return this}},{ATTRS:{photoUrl:{value:"/images/spaceball.gif",getter:function(t,e){var o=this.get("model").getValue("photo"),a=this.get("layoutItem");null===o&&i.warn("Photo model empty for tag");return o.getSizeToFit({width:a.geometry.width,height:a.geometry.height},{includeSquare:!0}).url}}}})},"@VERSION@",{requires:["photo-list-subview","hermes-template-photo-list-tag","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]});