YUI.add("flickr-groups-search-fetcher",function(e,r){"use strict";function s(r){var s=e.merge(r)||{},p={extras:e.APIHelper.request.getRebootGroupExtras()+",use_vespa,membership_info,has_pending_invite,secure_rules",per_page:20,page:1,secure_image_embeds:1},t={filter_inactive_groups:"1",sort:e.SearchHelper.API_SORT_OPTIONS.relevant},a={perPage:"per_page",userId:e.SearchHelper.GROUPS_SEARCH_API.userId,subscriptionTypes:e.SearchHelper.GROUPS_SEARCH_API.subscriptionTypes,filterInactiveGroups:e.SearchHelper.GROUPS_SEARCH_API.filterInactive,safeSearch:e.SearchHelper.GROUPS_SEARCH_API.safeSearch};return Object.keys(s).forEach(function(e){a[e]&&(void 0!==s[e]&&(s[a[e]]=s[e]),delete s[e])}),s=e.merge(p,t,s),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(s),s.text?s:null}e.namespace("ListFetchers")["flickr-groups-search"]={run:function(p,t){var a=s(p),o=[];return a||(p.emptyQuery=!0),p.emptyQuery?o.push(e.Promise.resolve({groups:{group:[]}})):o.push(t.callAPI("flickr.groups.search",a)),o=o.concat([t.getModelRegistry("search-groups-models"),t.getModelRegistry("search-group-models")]),e.Promise.all(o).then(function(e){return this._processResponse(e,p)}.bind(this),e.FetcherErrorLogger(r))},_processParams:s,_processResponse:function(r,s){var p,t,a,o,u,i=[],g=r[0],l=r[1],c=r[2];if(g.groups&&g.groups.group){for(a=g.groups.group.length,o=0;o<a;o++)u=g.groups.group[o],p=c.parseGroupModel(u.nsid,u.pathAlias,u),i.push(c.addOrUpdate(p));if(t={id:s.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},groups:{perPage:g.groups.perpage,page:g.groups.page||1,pageContent:i,totalItems:g.groups.total,totalPages:g.groups.pages},totalItems:g.groups.total,emptyQuery:!!s.emptyQuery,text:s.text,subscriptionTypes:s.subscriptionTypes,userId:s.userId,filterInactiveGroups:s.filterInactiveGroups,sort:s.sort},g.groups.maxAllowedResults&&(t.groups.totalItems=Math.min(g.groups.maxAllowedResults,g.groups.total)),g.groups.maxAllowedPages&&(t.groups.totalPages=Math.min(g.groups.maxAllowedPages,g.groups.pages)),a)for(a;a<t.groups.perPage;a++)t.groups.pageContent.push(!1);return s.id&&s.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(t.apiParams=s.apiParams),l.addOrUpdate(t),i}}}},"@VERSION@",{requires:["api-helper","flickr-promise","search-helper","search-url","querystring-stringify-simple"]});YUI.add("search-groups-models",function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-groups-search"].run(t,this.appContext)}},attributes:{id:{},text:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},subscriptionTypes:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},userId:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},groups:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-search"],listItemIdField:"id"}},filterInactiveGroups:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},sort:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},page:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},pages:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},perPage:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["attribute-helpers","flickr-model-registry","flickr-groups-search-fetcher","search-helper"]});