YUI.add("flickr-groups-updateViewDate-updater",function(e,r){"use strict";e.namespace("ModelUpdaters")["flickr-groups-updateViewDate"]={run:function(t,u){return u.callAPI("flickr.groups.updateViewDate",t).then(null,e.FetcherErrorLogger(r))}}},"@VERSION@",{requires:["flickr-promise"]});YUI.add("group-activity-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-groups-getInfo"].run(t,this.appContext)},updateViewDate:function(t,i){return e.ModelUpdaters["flickr-groups-updateViewDate"].run(t,i)}},groupViewed:function(t,i){"pool"===t.type?this.setValue(t.group_id,"viewedPool",e.moment()):"discussion"===t.type&&this.setValue(t.group_id,"viewedDiscussions",e.moment()),this.remote.updateViewDate(t,i)},getDefaultViewedDate:function(){return e.moment().subtract(13,"days")},attributes:{viewedDiscussions:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(e){return this.getDefaultViewedDate()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},viewedPool:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(e){return this.getDefaultViewedDate()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},latestViewedDate:{readOnly:!0,derivedBy:["viewedDiscussions","viewedPool"],getter:function(t,i){var r=this.getValue(i,"viewedPool"),u=this.getValue(i,"viewedDiscussions");return e.moment.max(u,r)}},hasNewActivity:{readOnly:!0,derivedBy:["latestViewedDate","group"],defaultFn:function(t){var i=this.getValue(t,"latestViewedDate"),r=this.getValue(t,"group").getValue("latestDiscussionActivity"),u=this.getValue(t,"group").getValue("latestPhotoActivity"),n=e.moment.max(u,r),o=i.clone().add(2,"w");return n.diff(i)>0&&n.diff(o)<0}},group:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-updateViewDate-updater","flickr-people-getInfo-fetcher"]});